=== PREFILL TOKEN GENERATION DEBUG ===
Input sequence: [128000, 791, 3938, 315, 21075, 11478, 374]
Input text: '<|begin_of_text|>The future of artificial intelligence is'
Next token logits shape: torch.Size([128256])
Top 8 tokens:
  1. Token 1618: ' here' (prob: -1.8359)
  2. Token 304: ' in' (prob: -2.6484)
  3. Token 1457: ' now' (prob: -2.8672)
  4. Token 539: ' not' (prob: -3.3516)
  5. Token 10107: ' bright' (prob: -3.4141)
  6. Token 2736: ' already' (prob: -3.4453)
  7. Token 1694: ' being' (prob: -3.4609)
  8. Token 264: ' a' (prob: -3.6797)
==================================================

[BeamState] add_filtered_results: 1 results, 1 current candidates
  [BRANCH CLEANUP] Checking for branches to eliminate...
    [BRANCH KEPT] Candidate 0 (score=0.0000) has 4 children

  [EXPAND] Expanding surviving candidates...
    [EXPAND 0] Node page_id=0, tokens=7/8, children=4
      [MULTIPLE CHILDREN] 4 branches
        [PARTIAL PAGE] Reusing page 0 for first child, copying for 3 others
          [PAGE COPY] Page 1 copied from 0 (7 tokens) for child 1: token_id=304, score=-2.6484
          [PAGE COPY] Page 2 copied from 0 (7 tokens) for child 2: token_id=1457, score=-2.8672
          [PAGE COPY] Page 3 copied from 0 (7 tokens) for child 3: token_id=539, score=-3.3516
          [APPEND] First child token_id=1618 appended to page 0, score=-1.8359

  [RESULT] 4 new candidates created

Expanded root into 4 beam candidates

================================================================================
================================================================================
=== DECODE STEP 1 ===
================================================================================
[STEP START] 4 active candidates before this step
  Candidate 0: score=-2.6484, len=8, page_id=1
    Current text: '<|begin_of_text|>The future of artificial intelligence is in'
  Candidate 1: score=-2.8672, len=8, page_id=2
    Current text: '<|begin_of_text|>The future of artificial intelligence is now'
  Candidate 2: score=-3.3516, len=8, page_id=3
    Current text: '<|begin_of_text|>The future of artificial intelligence is not'
  Candidate 3: score=-1.8359, len=8, page_id=0
    Current text: '<|begin_of_text|>The future of artificial intelligence is here'

[CASCADE] Building cascade input for 4 candidates
  [CASCADE] Built 1 cascade levels
    Level 0: 4 groups, 4 candidates
      qo_indptr: [0, 1, 2, 3, 4]
      kv_indptr: [0, 1, 2, 3, 4]
      kv_indices: [1, 2, 3, 0]
      kv_last_page_len: [7, 7, 7, 7]
  [CASCADE] Query token IDs: [304, 1457, 539, 1618]

[DECODE INPUT] Cascade levels: 1, Candidates: 4, Query tokens: 4
[DECODE INPUT] Query tokens: [304, 1457, 539, 1618]
[DECODE INPUT] Query texts: [' in', ' now', ' not', ' here']
[DECODE INPUT] Write page indices: [1, 2, 3, 0]
[DECODE INPUT] Write positions: [7, 7, 7, 7]
[DECODE INPUT] Position IDs: [7, 7, 7, 7]

[TOKEN SELECTION] Processing 4 candidates
  [Candidate 0] score=-2.6484, page_id=1
    Top 5 token candidates:
      1. Token 279: ' the' (log_prob: -1.3311)
      2. Token 701: ' your' (log_prob: -2.9238)
      3. Token 1057: ' our' (log_prob: -3.3457)
      4. Token 264: ' a' (log_prob: -3.6270)
      5. Token 1202: ' its' (log_prob: -4.1602)
  [Candidate 1] score=-2.8672, page_id=2
    Top 5 token candidates:
      1. Token 13: '.' (log_prob: -1.7549)
      2. Token 11: ',' (log_prob: -1.9580)
      3. Token 198: '
' (log_prob: -2.1602)
      4. Token 25: ':' (log_prob: -2.6758)
      5. Token 627: '.
' (log_prob: -2.7852)
  [Candidate 2] score=-3.3516, page_id=3
    Top 5 token candidates:
      1. Token 304: ' in' (log_prob: -2.1602)
      2. Token 1120: ' just' (log_prob: -2.3945)
      3. Token 1193: ' only' (log_prob: -2.7852)
      4. Token 264: ' a' (log_prob: -2.8633)
      5. Token 1148: ' what' (log_prob: -3.3789)
  [Candidate 3] score=-1.8359, page_id=0
    Top 5 token candidates:
      1. Token 13: '.' (log_prob: -1.7188)
      2. Token 11: ',' (log_prob: -1.8125)
      3. Token 1457: ' now' (log_prob: -2.4219)
      4. Token 323: ' and' (log_prob: -2.5625)
      5. Token 198: '
' (log_prob: -2.5938)

[STRATEGY] Selecting candidates using VanillaBeamSearchStrategy

[STRATEGY RESULTS] 4 results selected
  Result 0: 1 tokens selected: [279] -> [' the']
  Result 1: NO CHILDREN (will be eliminated)
  Result 2: NO CHILDREN (will be eliminated)
  Result 3: 3 tokens selected: [13, 11, 1457] -> ['.', ',', ' now']

[BeamState] add_filtered_results: 4 results, 4 current candidates
  [BRANCH CLEANUP] Checking for branches to eliminate...
    [BRANCH KEPT] Candidate 0 (score=-2.6484) has 1 children
    [BRANCH ELIMINATED] Candidate 1 (score=-2.8672) has no children - eliminating
  [PAGE FREE] Pages freed (dead branch): [2]
    [BRANCH ELIMINATED] Candidate 2 (score=-3.3516) has no children - eliminating
  [PAGE FREE] Pages freed (dead branch): [3]
    [BRANCH KEPT] Candidate 3 (score=-1.8359) has 3 children

  [EXPAND] Expanding surviving candidates...
    [EXPAND 0] Node page_id=1, tokens=8/8, children=1
      [SINGLE CHILD] token_id=279, score=-3.9795
        [PAGE ALLOC] Page 4 allocated (parent page 1 is full)
    [EXPAND 3] Node page_id=0, tokens=8/8, children=3
      [MULTIPLE CHILDREN] 3 branches
        [FULL PAGE] Allocating 3 new pages
          [PAGE ALLOC] Page 5 for child 0: token_id=13, score=-3.5547
          [PAGE ALLOC] Page 6 for child 1: token_id=11, score=-3.6484
          [PAGE ALLOC] Page 7 for child 2: token_id=1457, score=-4.2578

  [RESULT] 4 new candidates created

[BEAM STATE] After filtering: 4 active candidates
  Candidate 0 (score=-3.9795): 9 tokens
    Text: '<|begin_of_text|>The future of artificial intelligence is in the'
  Candidate 1 (score=-3.5547): 9 tokens
    Text: '<|begin_of_text|>The future of artificial intelligence is here.'
  Candidate 2 (score=-3.6484): 9 tokens
    Text: '<|begin_of_text|>The future of artificial intelligence is here,'
  Candidate 3 (score=-4.2578): 9 tokens
    Text: '<|begin_of_text|>The future of artificial intelligence is here now'

================================================================================
================================================================================
=== DECODE STEP 2 ===
================================================================================
[STEP START] 4 active candidates before this step
  Candidate 0: score=-3.9795, len=9, page_id=4
    Current text: '<|begin_of_text|>The future of artificial intelligence is in the'
  Candidate 1: score=-3.5547, len=9, page_id=5
    Current text: '<|begin_of_text|>The future of artificial intelligence is here.'
  Candidate 2: score=-3.6484, len=9, page_id=6
    Current text: '<|begin_of_text|>The future of artificial intelligence is here,'
  Candidate 3: score=-4.2578, len=9, page_id=7
    Current text: '<|begin_of_text|>The future of artificial intelligence is here now'

[CASCADE] Building cascade input for 4 candidates
  [CASCADE] Built 2 cascade levels
    Level 0: 2 groups, 4 candidates
      qo_indptr: [0, 1, 4]
      kv_indptr: [0, 2, 3]
      kv_indices: [1, 4, 0]
      kv_last_page_len: [0, 8]
    Level 1: 3 groups, 3 candidates
      qo_indptr: [0, 1, 2, 3]
      kv_indptr: [0, 1, 2, 3]
      kv_indices: [5, 6, 7]
      kv_last_page_len: [0, 0, 0]
  [CASCADE] Query token IDs: [279, 13, 11, 1457]

[DECODE INPUT] Cascade levels: 2, Candidates: 4, Query tokens: 4
[DECODE INPUT] Query tokens: [279, 13, 11, 1457]
[DECODE INPUT] Query texts: [' the', '.', ',', ' now']
[DECODE INPUT] Write page indices: [4, 5, 6, 7]
[DECODE INPUT] Write positions: [0, 0, 0, 0]
[DECODE INPUT] Position IDs: [8, 8, 8, 8]

[TOKEN SELECTION] Processing 4 candidates
  [Candidate 0] score=-3.9795, page_id=4
    Top 5 token candidates:
      1. Token 6206: ' hands' (log_prob: -1.1064)
      2. Token 9624: ' cloud' (log_prob: -1.9346)
      3. Token 33552: ' palm' (log_prob: -3.7949)
      4. Token 30614: ' clouds' (log_prob: -3.9512)
      5. Token 3805: ' air' (log_prob: -4.3711)
  [Candidate 1] score=-3.5547, page_id=5
    Top 5 token candidates:
      1. Token 1628: ' And' (log_prob: -2.7930)
      2. Token 2030: ' But' (log_prob: -3.0117)
      3. Token 1102: ' It' (log_prob: -3.0430)
      4. Token 578: ' The' (log_prob: -3.2305)
      5. Token 763: ' In' (log_prob: -3.3555)
  [Candidate 2] score=-3.6484, page_id=6
    Top 5 token candidates:
      1. Token 323: ' and' (log_prob: -0.5908)
      2. Token 719: ' but' (log_prob: -1.7627)
      3. Token 449: ' with' (log_prob: -3.9355)
      4. Token 1457: ' now' (log_prob: -4.0586)
      5. Token 433: ' it' (log_prob: -4.1523)
  [Candidate 3] score=-4.2578, page_id=7
    Top 5 token candidates:
      1. Token 315: ' of' (log_prob: -1.0430)
      2. Token 13: '.' (log_prob: -2.8320)
      3. Token 11: ',' (log_prob: -3.4648)
      4. Token 520: ' at' (log_prob: -4.1289)
      5. Token 323: ' and' (log_prob: -4.1758)

[STRATEGY] Selecting candidates using VanillaBeamSearchStrategy

[STRATEGY RESULTS] 4 results selected
  Result 0: 1 tokens selected: [6206] -> [' hands']
  Result 1: NO CHILDREN (will be eliminated)
  Result 2: 2 tokens selected: [323, 719] -> [' and', ' but']
  Result 3: 1 tokens selected: [315] -> [' of']

[BeamState] add_filtered_results: 4 results, 4 current candidates
  [BRANCH CLEANUP] Checking for branches to eliminate...
    [BRANCH KEPT] Candidate 0 (score=-3.9795) has 1 children
    [BRANCH ELIMINATED] Candidate 1 (score=-3.5547) has no children - eliminating
  [PAGE FREE] Pages freed (dead branch): [5]
    [BRANCH KEPT] Candidate 2 (score=-3.6484) has 2 children
    [BRANCH KEPT] Candidate 3 (score=-4.2578) has 1 children

  [EXPAND] Expanding surviving candidates...
    [EXPAND 0] Node page_id=4, tokens=1/8, children=1
      [SINGLE CHILD] token_id=6206, score=-5.0859
        [APPEND] Appended to existing page 4 (now 2/8 tokens)
    [EXPAND 2] Node page_id=6, tokens=1/8, children=2
      [MULTIPLE CHILDREN] 2 branches
        [PARTIAL PAGE] Reusing page 6 for first child, copying for 1 others
          [PAGE COPY] Page 8 copied from 6 (1 tokens) for child 1: token_id=719, score=-5.4111
          [APPEND] First child token_id=323 appended to page 6, score=-4.2393
    [EXPAND 3] Node page_id=7, tokens=1/8, children=1
      [SINGLE CHILD] token_id=315, score=-5.3008
        [APPEND] Appended to existing page 7 (now 2/8 tokens)

  [RESULT] 4 new candidates created

[BEAM STATE] After filtering: 4 active candidates
  Candidate 0 (score=-5.0859): 10 tokens
    Text: '<|begin_of_text|>The future of artificial intelligence is in the hands'
  Candidate 1 (score=-5.4111): 10 tokens
    Text: '<|begin_of_text|>The future of artificial intelligence is here, but'
  Candidate 2 (score=-4.2393): 10 tokens
    Text: '<|begin_of_text|>The future of artificial intelligence is here, and'
  Candidate 3 (score=-5.3008): 10 tokens
    Text: '<|begin_of_text|>The future of artificial intelligence is here now of'

================================================================================
=== FINAL RESULTS ===
================================================================================

[FINAL 1] Score: -0.4239, Tokens: 10
  Full token sequence: [128000, 791, 3938, 315, 21075, 11478, 374, 1618, 11, 323]
  Text: The future of artificial intelligence is here, and

[FINAL 2] Score: -0.5086, Tokens: 10
  Full token sequence: [128000, 791, 3938, 315, 21075, 11478, 374, 304, 279, 6206]
  Text: The future of artificial intelligence is in the hands

[FINAL 3] Score: -0.5301, Tokens: 10
  Full token sequence: [128000, 791, 3938, 315, 21075, 11478, 374, 1618, 1457, 315]
  Text: The future of artificial intelligence is here now of

[FINAL 4] Score: -0.5411, Tokens: 10
  Full token sequence: [128000, 791, 3938, 315, 21075, 11478, 374, 1618, 11, 719]
  Text: The future of artificial intelligence is here, but

[PAGE TABLE] Statistics:
  Total pages allocated: (tracked in page_table)
  Page size: 8

================================================================================
=== COMPARISON ===
================================================================================

HuggingFace Results:
  1. The future of artificial intelligence is here, and
  2. The future of artificial intelligence is in the hands
  3. The future of artificial intelligence is here, but
  4. The future of artificial intelligence is here. It

Custom Cascade Results:
  1. The future of artificial intelligence is here, and
  2. The future of artificial intelligence is in the hands
  3. The future of artificial intelligence is here now of
  4. The future of artificial intelligence is here, but